/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: MAZE
@author:Rares Buznea 
@tags: []
@addedOn: 2024-00-00
*/

const player = "p";
const player2 = "a";
const wall = "w";
const horizontal = "h";
const corner = "c";
const point = "o";
const line = "l";
const cube = "u";
const side = "s";
const power = "e";
const place = "q";

setLegend(
  [ player, bitmap`
1111111111111111
1111111111111111
1111111111111111
1110000111000011
1110000111000011
1110000111000011
1110000111000011
1111111111111111
1111111111111111
1111111111111111
1100000000000011
1100000000000011
1100000000000011
1111111111111111
1111111111111111
1111111111111111` ],
  [ player2,  bitmap`
LLCCLLLCCLLLCCLL
LLCCLLLCCLLLCCLL
LLCCLLLCCLLLCCLL
CCCCCCCCCCCCCCCC
LLCCLLLCCLLLCCLL
LLCCLLLCCLLLCCLL
33CC333CC333CC33
33CC333CC333CC33
33CC333CC333CC33
4444444444444444
4444444444444444
33CC333CC333CC33
33CC333CC333CC33
LLCCLLLCCLLLCCLL
LLCCLLLCCLLLCCLL
LLCCLLLCCLLLCCLL` ],
  [ wall, bitmap`
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........
77777...........` ],
  [ horizontal, bitmap`
................
CCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCC
................
................
................
................
................
................
................
................
................
................
................` ],
  [ corner, bitmap`
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........
LLLLL...........` ],
  [ point, bitmap`
444.............
444.............
444.............
444.............
444.............
444.............
444.............
444.............
................
................
................
................
................
................
................
................` ],
  [ line, bitmap`
3333............
3333............
3333............
3333............
3333............
3333............
3333............
................
................
................
................
................
................
................
................
................` ],
  [ cube, bitmap`
................
................
................
................
................
................
................
................
................
................
CCCCC...........
CCCCC...........
CCCCC...........
CCCCC...........
CCCCC...........
CCCCC...........` ],
  [ side, bitmap`
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777
...........77777` ],
  [ power, bitmap`
LL222277772222LL
LL222277772222LL
LL000000000000LL
LL000000000000LL
LL000000000000LL
LL222277772222LL
LL222277772222LL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
7777777777777777
7777777777777777
7777777777777777
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLL` ],
  [ place, bitmap`
FFFF............
FFFFF...........
FFFFFF..........
FFFFFFF.........
.FFFFFFF........
..FFFFFFF.......
...FFFFFFF......
....FFFFFFF.....
.....FFFFFFF....
......FFFFFFF...
.......FFFFFFF..
........FFFFFFF.
.........FFFFFFF
..........FFFFFF
...........FFFFF
............FFFF` ],
);

let level = 0;
const levels = [
  map`
s......w.
.hw.w.cow
qhhhhhoh.
s.....wq.
...w.....
.clcqs.s.
pw....uqe`,
  map`
e.w.c.a....c.c
.c....cs.w...w
....huw..s.s..
.h..c.s.h....u
.cl.w.h.hs.cho
......hs....h.
..s.w........c
..c..hs.suhc.o
.c.wsc...w.w..
ew.s..w.cl.hsp`,
],

currentLevel = levels[level];
setMap(currentLevel);

setSolids([player, player2, wall, horizontal, corner, point, line, cube, side, place]);

setPushables({
  [player]: []
});

onInput("w", () => {
  getFirst(player).y -= 1;
});

onInput("a", () => {
  getFirst(player).x -= 1;
});

onInput("s", () => {
  getFirst(player).y += 1;
});

onInput("d", () => {
  getFirst(player).x += 1;
});

onInput("i", () => {
  getFirst(player2).y +=-1});
  onInput("j", () => {
  getFirst(player2).x -= 1});
    onInput("k", () => {
  getFirst(player2).y -=-1});
      onInput("l", () => {
  getFirst(player2).x += 1
      });

afterInput(() => {
 const targetNumber = tilesWith(power).length; 
  const targetNumber2 = tilesWith(power).length; 

  const targetNumberboth = targetNumber + targetNumber2; 

  const numberCovered = tilesWith(power, player).length;
  const numberCovered2 = tilesWith(power, player2).length; 

  const bothCovered = numberCovered + numberCovered2;

  if (numberCovered === targetNumber) {
    level = level + 1;
    const currentLevel = levels[level];

    if (currentLevel !== undefined) {
      setMap(currentLevel);
    } else {
      addText("You win!", { y: 1, color: 2 });
    }
  }
});