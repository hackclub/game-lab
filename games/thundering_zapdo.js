// Step 1: Set up your sprites
const player = "p";
const wall = "w";
const treasure = "t";

// Step 2: Create the legend
setLegend(
  [player, bitmap`
................
................
................
................
.......00.......
......0..0......
.....0....0.....
.....0....0.....
.....0....0.....
.....0....0.....
......0..0......
.......00.......
................
................
................
................`],
  [wall, bitmap`
................
................
................
.....000000.....
....00000000....
....00000000....
....00000000....
....00000000....
....00000000....
....00000000....
....00000000....
....00000000....
.....000000.....
................
................
................`],
  [treasure, bitmap`
................
.....00....00...
....0000..0000..
....0000000000..
....0000000000..
....0000000000..
....0000000000..
....0000000000..
....0000000000..
....0000000000..
....0000..0000..
.....00....00...
................
................
................`]
);

// Step 3: Set up the map
const level = map`
wwwwwwwwwwww
w..........w
w....t.....w
w..........w
w....p.....w
w..........w
w..........w
w..........w
w..........w
wwwwwwwwwwww`;

setMap(level);

// Step 4: Set up game logic
setSolids([player, wall]);

// Handle player movement
onInput("w", () => {
  getFirst(player).y -= 1;
});

onInput("a", () => {
  getFirst(player).x -= 1;
});

onInput("s", () => {
  getFirst(player).y += 1;
});

onInput("d", () => {
  getFirst(player).x += 1;
});

// Check for collisions with treasure
afterInput(() => {
  const playerSprite = getFirst(player);
  const treasures = tilesWith(treasure, player);

  if (treasures.length > 0) {
    const treasureTile = treasures[0];
    clearTile(treasureTile.x, treasureTile.y);
    addText("You Win!", { x: 10, y: 4, color: color`3` });
  }
});
