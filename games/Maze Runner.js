const player = "p"
const v_wall = "v"
const h_wall = "h"
const u_r = "a"
const u_l = "b"
const d_r = "c"
const d_l = "d"
const c_r = "f"
const c_l = "g"
const c_u = "i"
const c_d = "j"
const goal = "w"

setLegend(
  [ player, bitmap`
................
................
.......000......
.......0.0......
......0..0......
......0...0.0...
....0003.30.0...
....0.0...000...
....0.05550.....
......0...0.....
.....0....0.....
.....0...0......
......000.......
......0.0.......
.....00.00......
................` ],
  [ v_wall, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ h_wall, bitmap`
................
................
................
................
................
................
0000000000000000
0000000000000000
0000000000000000
0000000000000000
................
................
................
................
................
................` ],
  [ u_r, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000000000
......0000000000
......0000000000
......0000000000
................
................
................
................
................
................` ],
  [ u_l, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
0000000000......
0000000000......
0000000000......
0000000000......
................
................
................
................
................
................` ],
  [ d_r, bitmap`
................
................
................
................
................
................
......0000000000
......0000000000
......0000000000
......0000000000
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ d_l, bitmap`
................
................
................
................
................
................
0000000000......
0000000000......
0000000000......
0000000000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ c_r, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000000000
......0000000000
......0000000000
......0000000000
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ c_l, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
0000000000......
0000000000......
0000000000......
0000000000......
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ c_d, bitmap`
................
................
................
................
................
................
0000000000000000
0000000000000000
0000000000000000
0000000000000000
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......` ],
  [ c_u, bitmap`
......0000......
......0000......
......0000......
......0000......
......0000......
......0000......
0000000000000000
0000000000000000
0000000000000000
0000000000000000
................
................
................
................
................
................` ],
  [ goal, bitmap`
...6666666666...
.66666666666666.
.6.6666666666.6.
.6.6666666666.6.
.66666666666666.
...6666666666...
....66666666....
.....666666.....
......6666......
......6666......
......6666......
......6666......
......6666......
.....666666.....
....66666666....
...6666666666...` ]
)

setSolids([ player, v_wall, h_wall, u_r, u_l, d_r, d_l, c_r, c_l, c_u, c_d ])

let level = 0
const levels = [
  map`
chjpjhhhhhhd
v.v.v......v
v.v.ahhd.v.v
v......v.v.v
fhd.v....fhg
v.v.fhhhhg.w
v...v....v.v
v.v.v.v.hb.v
v.v.v.v....v
v.ahb.v.ch.v
v.....v.v..v
ahhhhhihihhb`,
  map`
chhhhhjhhhhhd
v.....v.....v
v.hhd.v.chhhg
v...v.v.v...v
ahh.v.v.v.v.v
p...v.v...v.v
chhhb.fhh.v.v
v.....v...v.v
v.chhhb.chb.v
v.v.....v...v
v.ahhhh.v.v.v
v.......v.v.v
ahhhhhhhbwahb`,
  map`
chhhhhjhhhjhhhjhhhhhh
v.....v...v...v.....w
fhd.v.ahd.v.v.ahhhh.v
v.v.v...v...v.......v
v.v.ahd.v.chihjhh.chg
v.v...v...v...v...v.v
v.ahd.ahhhg.chihjhb.v
v...v.....v.v...v...v
v.chihh.chb.v.v.ahh.v
v.v.....v...v.v.....v
v.v.hhjhg.hhb.v.v.chg
v.v...v.v.....v.v.v.v
v.ahh.v.ahh.hhb.v.v.v
v...............v.v.v
fhhhh.v.chd.chhhb.v.v
v.....v.v.v.v.......v
v.chh.v.v.v.v.v.chhhg
v.v.....v.....v.v...v
v.ahhhh.v.hhd.ahb.v.v
p...........v.....v.v
hhhhhhhhhhhhihhhhhihb`
]

setMap(levels[level])

setPushables({
  [ player ]: []
})

onInput("s", () => {
  getFirst(player).y += 1
})

onInput("w", () => {
  getFirst(player).y -= 1
})

onInput("a", () => {
  getFirst(player).x -= 1
})

onInput("d", () => {
  getFirst(player).x += 1
})

afterInput(() => {
  if (tilesWith(goal, player).length === 1) {
    if (level === levels.length - 1) {
      // Check if the current level is the last level
      addText("YOU WIN!", { y: 4, color: color`3` })
    } else {
      level += 1;
      setMap(levels[level]); // Change the map to the next level
    }
  }
})