/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: Toilet Cleaning Simulator
@author: klaus-E2S
@tags: ['simulation', 'humor']
@addedOn: 2024-11-12
*/

const player = "p"
const toilet = "t"
const tp = "q"
const victory1 = [tune`
500: C4-500,
15500`]
const s = "s"
const t = "y"
const o = "o"
const r = "r"
const e = "e"
const plunger = "l"

setLegend(
  [ player, bitmap`
................
................
................
.....CLLLC......
....CL5L5LC.....
...CCLLLLL555...
....CC2020CC....
.....C2222C.....
.....75557......
....7755577.....
...22.555.22....
..22..5.5..22...
......5.5.......
......5.5.......
.....00.00......
................` ],
  [ toilet, bitmap`
0000000000000000
0222222222222220
0000000000000000
...0222222220...
...0222222220...
...0222222220...
...0222222220...
...0222222220...
..000000000000..
.01111111111110.
.00LLLLLLLLLL00.
.02000000000020.
.02222222222220.
0002222222222000
0220000000000220
0000000000000000` ],
  [ tp, bitmap`
................
..000...........
.022200.........
.0202200........
0202202200......
02220222220.....
.020222222200...
..022222222220..
...02222222220..
....0222222220..
.....02222220...
......0222220...
.......00220....
.........00.....
................
................`],
  [ s, bitmap`
................
................
........000000..
.....0000.......
...00...........
...0............
...000..........
......00000.....
..........0.....
..........0.....
..00.....00.....
....000000......
................
................
................
................`],
  [ t, bitmap`
................
.......0........
.......0........
......000000....
.00000.00..0000.
........0.......
........0.......
........0.......
........0.......
.......0........
.......0........
.......0........
.......0........
.......0........
.......0........
................`],
  [ o, bitmap`
................
......000.......
....00..00000...
...00.......00..
..0..........0..
..0..........0..
.0...........0..
00...........0..
0............0..
.0...........0..
.00..........0..
..00.........0..
....00......0...
.....000....0...
........0000....
................`],
  [ r, bitmap`
................
................
................
..0.............
..0.0000000.....
..000.....00....
..00.......0....
...0............
...0............
...0............
...0............
...0............
...0............
...0............
................
................`],
  [ e, bitmap`
................
................
................
................
......000000....
....00.....0....
...0.......0....
..0.00..000.....
..0...00........
..0.............
..00............
...0............
....0...........
.....0000.......
.........0000...
................`],
  [ plunger, bitmap`
................
................
................
..44............
..444...........
...444..........
....444.........
.....444........
......444.......
.......443333...
......33333033..
......33300033..
......3330333...
......333333....
................
................`]
)

let level = 0
const levels = [ 
  map`
.....
...q.
..p..
.....
.t...`,
  map`
.............
.............
.......syore.
.............
........q.l..
.............
.............
.............
.............
.p...........
.t...........`
]

setMap(levels[level])

setPushables({
  [ player ]: [ tp ],
  [ plunger ]: [ plunger ]
})

setSolids([ player, tp ], [player, plunger])

onInput("s", () => {
  getFirst(player).y += 1;
})

onInput("w", () => {
  getFirst(player).y += -1
})

onInput("a", () => {
  getFirst(player).x += -1
})

onInput("d", () => {
  getFirst(player).x += 1
})

onInput("j", () => {
  const currentLevel = levels[level]; 

  if (currentLevel !== undefined) {
    clearText("");
    setMap(currentLevel);
  }
});

afterInput(() => {
  const targetNumber = tilesWith(toilet).length;
  const numberCovered = tilesWith(toilet, tp).length;
  const numberCovered2 = tilesWith(toilet, plunger).length;
  if (numberCovered == targetNumber) {
    level = level + 1;
    const currentLevel = levels[level];
    if (currentLevel !== undefined) {
      setMap(currentLevel);
    } else {
      addText("toilet cleaned! :D", { y : 4 });
    }
  }
})
